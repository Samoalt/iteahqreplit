â¬›ï¸ GLOBAL APP METADATA
json
Copy
Edit
{
  "tenant": "itea-flow",
  "brand": {
    "name": "iTea Flow",
    "footer": "powered by Elastic OS",
    "primary": "#01624E",          // deep-green
    "accent":  "#3B82F6",          // electric-blue
    "font":    "Inter"
  },
  "workspaces": ["Producer", "Buyer", "KTDA Board"],
  "wsRoleMatrix": {
    "Producer": ["producer"],
    "Buyer"   : ["buyer"],
    "KTDA Board": ["ktda_ro"]
  }
}
1 â–¸ NAVIGATION SHELL (shared layout)
pgsql
Copy
Edit
Left Sidebar Items
  ðŸ  Dashboard
  ðŸ“¦ Lots & Invoices  â–¾       â†’   Sub-tabs: Catalogue | Live Lots | Invoices
  ðŸ’¼ Wallets & Settlement
  ðŸš€ Instant Cash      (visible if role=producer)
  ðŸ’± FX & Credit       (visible if role IN [buyer,lender])
  ðŸ›¡ Insurance Hub
  ðŸ“‘ Statements & Reports
  ðŸ› Board View        (visible if role=ktda_ro)
  ðŸ”” Alerts
  âš™ï¸ Admin             (visible if role=ops_admin)
Top Bar
  â€¢ Live-auction timer  â€¢ Workspace switcher  â€¢ User avatar + role
2 â–¸ STATUS COLOUR TOKENS (central theme)
Token name	Hex	Used for
status-green	#10B981	Paid âœ”, Cash ready âš¡, Loan active
status-blue	#3B82F6	In clearing, Processing
status-amber	#FABB00	Review, Out-bid, Buffer low
status-red	#F04438	Error, Overdue, Suspended
status-grey	#6B7280	Draft, Queued

3 â–¸ COMPONENT SPECIFICATIONS (per screen)
3.1 LotCard (component id: LotCard)
mathematica
Copy
Edit
Props: {lotId, saleNo, factory, grade, kg, offerPrice, qualityStars, esgLeaf,
        statusChip, canBid, canInstantCash}
Layout: 300 px wide card; two-row stack
  Row 1: Grade + lotId + timer (if live) right-aligned
  Row 2: Kg | OfferPrice | QualityStars â˜…â˜…â˜…â˜…â˜†
Badges: âš¡ Cash-Ready shows if producer & canInstantCash=true
Actions: 
  â€¢ If canBid â†’ Button â€œBid Nowâ€
  â€¢ If producer & canInstantCash â†’ Button â€œInstant Cashâ€
3.2 Bid Modal (BidModal)
makefile
Copy
Edit
Inputs: bidAmount (number), lockFx (toggle)
Displays: bestBid, reservePrice, liveFxQuote, utilisationBar (if bidCredit)
Validations: bid â‰¥ reservePrice; show fxQuote stale if >30 s
Emit: placeBid({lotId, bidAmount, lockFx})
3.3 Instant Cash Drawer (CashDrawer)
css
Copy
Edit
Slider 60-80 % LTV  â€¢ APR label 12 % p.a.
Lien checkbox auto-checked  â€¢ Accept / Cancel buttons
OnAccept â†’ emit drawLoan({lotId, pct})
3.4 Invoice Row (InvoiceRow)
Columns: Invoice#, Lots#, Amount USD, Status pill, Pay button, PDF link
Pay dropdown: Wallet | Wire(E-Slip) â†’ triggers generateESlip(invoiceId, method)

4 â–¸ SCREEN WIREFRAMES (HF = high fidelity wire)
4.1 Dashboard (HF)
pgsql
Copy
Edit
Four KPI cards (role-filtered)
Row-2: Small heat-map (lots by grade) + Recent activity feed
Status Bar: Unmatched ðŸ”´ | Review ðŸŸ  | Processing ðŸ”µ | Paid ðŸŸ¢
4.2 Lots & Invoices
Sub-tab Catalogue â†’ Table view with LotCard list
Sub-tab Live Lots â†’ Masonry grid of LotCards streaming WS events
Sub-tab Invoices â†’ InvoiceRow list + filters

4.3 Wallets & Settlement
Balance tiles (KES, USD) â†’ click tile opens ledger drawer
Deposit â†’ ACH/SWIFT modal â€¢ Withdraw â†’ RTGS/M-Pesa modal
Wire Tracker widget: In Clearing | Cleared âœ” | Overdue counts

4.4 FX & Credit
Tabs: FX Lock | Bid-Credit | Lender Pools
FX Lock card: live quote, amount input, Book button
Bid-Credit: limit dial + margin calls list
Lender Pools: card per pool (APR, utilisation, add liquidity)

4.5 Insurance Hub
Chip selector: Drought | Quality | Marine
Quote card â†’ Buy â†’ Claim wizard

4.6 Board View (KTDA workspace)
Sub-tabs: Overview â€¢ Factories â€¢ Payouts â€¢ Analytics
Factory table row-click opens modal with lots + payout timeline.

5 â–¸ WORKFLOW SPEC (STEP-BY-STEP)
#	Actor	Flow name	UI steps	Emitted events / API hits
1	Buyer	Bid on live lot	LiveLots â†’ click BidNow â†’ BidModal: enter price â†’ PlaceBid	POST /api/bid
2	Auction engine	Lot won	WS event lotWon â†’ Invoice auto-appears; card turns green	â€”
3	Buyer	Pay by wallet	InvoiceRow Pay â–¾ Wallet â†’ confirm debit	POST /invoice/:id/pay
4	Producer	Draw Instant Cash before sale	Catalogue â†’ InstantCash btn â†’ CashDrawer Accept	POST /credit/draw
5	Producer	Draw Advance after sale	Invoice Paid event â†’ Auto-advance 100 % minus fee	hand-led by Split engine
6	KTDA	Monitor payout SLA	BoardView â†’ Payouts timeline	passive
7	Ops	Flag overdue invoice	Alerts â†’ click row â†’ send reminder	POST /alerts/resolve

6 â–¸ STATUS TRANSITIONS (STATE MACHINE)
yaml
Copy
Edit
Lot status:  Draftâ†’Catalogueâ†’Liveâ†’Sold
Invoice:     Pendingâ†’InClearingâ†’Paid âœ”
Loan:        QuoteReadyâ†’Activeâ†’Repaidâœ”
Insurance:   Quotedâ†’Boundâ†’ClaimTriggeredâ†’Paidâœ”
7 â–¸ DUMMY DATA (Builder can inject)
10 factories (FAC01â€¦FAC10) with wallet IDs

3 buyers (BUY01â€¦BUY03) with USD wallets

LiveWS event every 15 s: bidUpdate, lotWon, invoicePaid

8 â–¸ ACCESS CONSTRAINTS
producer role hides BidModal; buyer hides CashDrawer.

ktda_ro role sets readOnly=true on every interactive component.